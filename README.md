# 📊 库存与出入库分析系统

一个基于Streamlit构建的Excel数据分析系统，专注于库存管理、入库分析和出库分析，提供强大的数据清洗和可视化功能。

## ✨ 主要功能

### 🎯 分析类型
- **📦 库存分析**: 库存状态、周转率、安全库存等指标分析
- **📥 入库分析**: 入库趋势、供应商表现、入库效率等指标分析  
- **📤 出库分析**: 出库趋势、客户需求、出库效率等指标分析

### 🧹 增强数据清洗功能
- **基础清洗**: 删除空值、重复值、格式标准化、数据类型转换
- **高级条件清洗**: 
  - 支持数学运算符：`>`, `>=`, `<`, `<=`, `==`, `!=`, `在范围内`, `不在范围内`, `包含`, `不包含`
  - 支持逻辑运算符：`且(AND)`, `或(OR)`
  - 支持多组条件：组内AND关系，组间OR关系
  - 支持多种处理方式：删除、标记异常、导出到新文件

### 📊 分析维度
- **异常数据清洗**: 智能检测并处理异常值、缺失值和不合理数据
- **ABC分析**: 按照重要性对物品进行分类，识别核心、重要和一般物品
- **装箱分析**: 分析装箱效率、箱型分布和装箱优化建议
- **容器分析**: 分析容器使用情况、容器选择优化和容量利用率
- **SKU件数分析**: 分析SKU入库件数分布、热门SKU识别和库存结构
- **入库箱数分析**: 分析入库箱数趋势、箱型分布和入库效率
- **订单结构分析**: 分析订单构成、订单类型分布和订单特征
- **单件多件分析**: 分析单件订单与多件订单的比例和特征差异
- **命中率分析**: 分析拣货命中率、准确率和效率指标

### 📄 PDF报告导出
- **完整报告生成**: 将多个分析模块结果整合到单个PDF报告
- **专业格式**: 包含封面、分析信息、详细结果和结论建议
- **自动汇总**: 生成关键指标汇总和统计信息
- **中文支持**: 完整的中文报告格式

## 🚀 快速开始

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行应用
```bash
streamlit run app.py
```

### 测试数据
运行以下命令生成包含异常数据的测试Excel文件：
```bash
python test_data.py
```

## 🔧 使用说明

### 四步分析流程
1. **选择分析类型**: 库存分析、入库分析或出库分析
2. **选择数据源**: 上传Excel文件并选择要分析的Sheet
3. **选择分析维度**: 勾选要执行的分析模块
4. **配置参数**: 为每个分析维度设置具体参数

### 数据清洗配置示例

#### 基础清洗规则
- ✅ 删除空值
- ✅ 删除重复值  
- ✅ 标准化格式
- ✅ 数据类型转换

#### 高级条件清洗示例
**条件组1**: 检测异常库存
- 条件1: 库存数量 < 0 (检测负库存)
- 逻辑: 或
- 条件2: 库存数量 > 10000 (检测异常高库存)

**条件组2**: 检测异常价格  
- 条件1: 单价 <= 0 (检测零价格或负价格)
- 逻辑: 或
- 条件2: 单价 > 1000 (检测异常高价格)

**组间关系**: 条件组1 OR 条件组2

### PDF报告功能
- 点击"导出完整PDF报告"按钮
- 系统自动整合所有分析结果
- 生成专业格式的中文报告
- 支持直接下载

## 📁 项目结构

```
创维数据分析/
├── app.py                 # 主应用程序
├── data_cleaning.py       # 数据清洗模块
├── analysis.py           # 分析功能模块
├── plot.py              # 图表绘制模块
├── report_generator.py   # PDF报告生成模块
├── test_data.py          # 测试数据生成脚本
├── requirements.txt      # 依赖包列表
├── README.md            # 项目说明文档
└── 测试数据.xlsx         # 自动生成的测试数据
```

## 🛠️ 技术栈

- **前端框架**: Streamlit
- **数据处理**: Pandas, NumPy
- **图表库**: Plotly
- **Excel处理**: OpenPyXL
- **PDF生成**: ReportLab
- **可视化**: Matplotlib, Seaborn

## 🔍 测试数据说明

系统提供包含1000条记录的测试数据，包含以下异常情况：
- ❌ 5条负库存记录
- ❌ 4条异常单价记录（零价格或负价格）
- ❌ 空值数据
- ❌ 5条重复商品编码
- ❌ 异常出库数量（超过库存）

## 🎨 界面特色

- 🌏 完整中文界面
- 📱 响应式设计
- 🎯 四步式清晰流程
- 📊 实时数据预览
- 💾 智能数据缓存
- 🔄 状态管理优化

## 🚧 开发路线图

- [x] 基础分析框架
- [x] 增强数据清洗功能
- [x] PDF报告导出
- [ ] ABC分析具体实现
- [ ] 容器分析功能
- [ ] 装箱分析算法
- [ ] 交互式图表优化
- [ ] 多语言支持扩展

## 📝 更新日志

### v2.0.0 (最新)
- ✨ 新增强数据清洗功能，支持复杂条件判断
- ✨ 新增PDF报告导出功能，支持多模块结果整合
- ✨ 新增测试数据生成脚本
- 🐛 修复数据缓存和状态管理问题
- 💄 优化用户界面和交互体验

### v1.0.0
- 🎉 初始版本发布
- ✨ 基础分析框架搭建
- ✨ 三种分析类型支持
- ✨ 多维度分析配置

## 🛡️ 代码保护规则

项目配置了Cursor AI代码保护规则，防止意外的代码修改：

### 📋 规则列表
- **🔒 高精度数值保护**: 禁止修改高精度浮点数（如 `3.14159` → `3.14`）
- **🔒 格式化数值控制**: 警告新增两位小数数值（防止AI自动格式化）
- **🔒 函数保护**: 禁止新增/删除函数和方法（保持功能稳定）
- **🔒 对象属性保护**: 禁止随意新增/删除对象属性（防止结构变更）

### 📄 配置文件
- `.cursorrules` - 人类可读的规则说明
- `.cursor-rules.json` - Cursor标准JSON格式规则
- `.vscode/settings.json` - VSCode/Cursor配置文件

### 🎯 规则目的
- 保护装箱分析等核心算法的计算精度
- 防止AI自动扩展或简化功能
- 维持现有API接口的稳定性
- 确保数据分析结果的准确性

## 🤝 贡献指南

欢迎提交Issues和Pull Requests来改进项目！请注意遵循代码保护规则。

## �� 许可证

MIT License 